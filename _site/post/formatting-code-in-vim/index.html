<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="Cache-control" content="public">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

    <!-- site info -->
    <meta name="author" content="Jeremy Warner">
    <meta name="robots" content="index, follow">
    <meta name="keywords" content="jeremy warner, berkeley, human computer interaction, online education, computer science, hci">
    <meta name="description" content="I am an EECS Ph.D. student at UC Berkeley, and am advised by Björn Hartmann. My research focuses on systems-building human computer interaction work - check out some of my projects. Before this, I attended the University of Rochester, where I worked with Philip Guo.
">
    <title>
      
        jeremy warner - formatting code in vim
      
    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/src/css/main.css">
    <link rel="stylesheet" href="/src/css/syntax.css">
    <link rel="alternate" type="application/rss+xml" title="Bakery Store RSS" href="/feed.xml">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Serif:400,400italic,700|PT+Sans:400">

    <!-- JS -->
    <script type="text/javascript" src="/src/js/ga.js" async></script>

    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/src/img/logo.png">
    <link rel="shortcut icon" href="/src/img/favicon.ico">

    <!-- Facebook -->
    <meta property="og:site_name"   content="Jeremy Warner"/>
    <meta property="og:description" content=" I am an EECS Ph.D. student at UC Berkeley, and am advised by Björn Hartmann. My research focuses on systems-building human computer interaction work - check out some of my projects. Before this, I attended the University of Rochester, where I worked with Philip Guo.
 " />
    <meta property="og:title"       content="Jeremy Warner  - formatting code in vim "/>
    <meta property="og:image"       content="  " />
  </head>
  <body>

    <div class="wrap">
      <!-- responsive masthead -->
      <div class="masthead">
        <div class="container">
          <div class="nav">
            <a href="/" title="home">home</a>
            <a href="/blog" title="blog">blog</a>
            <a href="https://twitter.com/jeremywrnr" target="_blank" title="twitter">twitter</a>
          </div>
        </div>
      </div>

      <div class="container">
        <div class="post-header">
    <h1 class="post-title" >Formatting Code In Vim</h1>
    <span class="post-meta">written oct 12, 2015</span>
    </br> <span class="post-meta"> by <a href="/">jeremy b. warner</a></span>
</div>

<p>I frequently use a vim mapping which formats and indent the entire file I am
editing, and then returns back to where the cursor initially was, centered on
the screen. Here it is, along with a deconstruction of what’s going on:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>nmap FG 1G=G``zz
</code></pre>
</div>

<ol>
  <li>nmap FG - make a normal-mode alias named FG. I sometimes remember this as ‘format good’</li>
  <li>1G - go to the first line of the file</li>
  <li>= - perform code indentation, until…</li>
  <li>G - going til the last line of the file</li>
  <li>```` - uses markers to jump back to the last position (which is whereever
you were before you jumped to the start of the file to format it)</li>
  <li><a href="http://vimdoc.sourceforge.net/htmldoc/scroll.html#zz">zz</a> - slides the
visible lines so that your cursor is in the middle of the screen, if possible</li>
</ol>

<p>Additionally, sometimes I just want to format a single selection of code. I can
do this my either visually selecting a section of text and then using ’<code class="highlighter-rouge">=</code>’ to
format it, or use ’<code class="highlighter-rouge">={some motion}</code>’ to format the text between where my cursor
is now, and where that motion would take me. For instance, to format a single
cohesive paragraph of code, I can use ’<code class="highlighter-rouge">=}</code>. Kinda looks a really smily guy, or
someone with a weird upside down mustache. More good vim formatting tips
<a href="http://www.cs.swarthmore.edu/help/vim/reformatting.html">here</a>.</p>

<h2 id="format-a-paragraph-to-80-chars-in-vim">format a paragraph to 80 chars in vim</h2>

<p>I have doing a lot of LaTeX editing recently, and my choice of text editor is
currently vim. I recently found out that you can make it so that when you hit
the 80th position in the line, vim enters a new line and brings the current
word you are on down to the next line. Awesome! This helps me keeping the
document organized, and can be enabled adding this to your .vimrc:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>set textwidth=79
set formatoptions+=t
</code></pre>
</div>

<p>Still, what about if you want to edit one line, and add content to it, making
that line longer than it initially was? Vim will split the current line at 80
characters, but nothing will happen to the rest of the paragraph. Example
below:</p>

<p><img src="https://31.media.tumblr.com/7066b3328c7ec2a9a48f89a07272e725/tumblr_inline_ngds06Pmo11s7hh2w.png" alt="" /></p>

<p>There will be this awkward short line in the middle of your paragraph…
unfortunately not awesome. So I made a mapping to a series of keys that selects
and reformats the current paragraph. so that the shortest line is the last,
just perfect. I mapped it to FP (format paragraph):</p>

<div class="highlighter-rouge"><pre class="highlight"><code>nmap FP {jV}kJgqq{j
</code></pre>
</div>

<p>So, quick breakdown on what is happening in this mapping:</p>

<ol>
  <li>{j - go to first line of paragraph</li>
  <li>V - enter visual line mode</li>
  <li>}k - move to last line of the paragraph</li>
  <li>J - join all lines onto 1 line</li>
  <li>gqq - format the current line</li>
  <li>{j - return to first line of paragraph</li>
</ol>

<h2 id="vimman-vimmake">vim→man, vim→make</h2>

<p>Here are two  cool tips that come in handy when working with vim. The first is
a slick integration with the system documentation for any command, and will
bring up documentation for whatever your cursor is hovering over:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>K (shift-k)
</code></pre>
</div>

<p>Another cool trick is that you can automatically run your makefile from vim,
just by entering</p>

<div class="highlighter-rouge"><pre class="highlight"><code>:make
</code></pre>
</div>

<p>You can also just enter :mak, and vim’s command autocomplete will take over.
This can save a lot of time when compared to quitting, running make, and
reopening vim. Yay workflow optimization!</p>



<!--sort and link the separate posts chronologically-->





<script>
document.body.onkeyup = function(e) {
  if (e.keyCode == '37') { window.location = '/post/ruby-gems-starter-guide/'; }
  if (e.keyCode == '39') { window.location = '/post/osx-print-from-terminal/'; }
};
</script>

<span class="post-meta">
    <a href="mailto:jeremy.warner@berkeley.edu">email</a> /
    <a href="https://twitter.com/jeremywrnr">tweet</a>
</span>

<div class="masthead">
   <a href="/post/ruby-gems-starter-guide/" class="prev">prev</a> 
  <a href="/blog">all</a>
   <a href="/post/osx-print-from-terminal/" class="nxt">next</a>
</div>


      </div>
    </div>

  </body>
</html>
